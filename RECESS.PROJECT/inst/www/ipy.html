<!DOCTYPE html>
<html>
    <head>
        <title>Fatality vs Year</title>
        <!-- Include order: first jquery, then opencpu.js, and then your code -->
        <script src="opencpu/jquery-1.10.2.min.js"></script>
        <script src="opencpu/opencpu-0.4.js"></script>
        <!-- include bootstrap.css -->
        <link href="bootstrap/css/bootstrap.css" type="text/css" rel="stylesheet" />
        <script src="js/pace.js"></script>
        <link href="css/center-circle.css" type="text/css" rel="stylesheet" />
        <script>
            //init this script when the page has loaded
            $(document).ready(function () {
                $("#submitbutton").on("click", function () {
                    //disable the button to prevent multiple clicks
                    $("#submitbutton").attr("disabled", "disabled");
                    //read the value for 'myname'
                    var fromYear = parseInt($("#startYr").val());
                    var toYear = parseInt($("#endYr").val());
                    var from_to = (1996 + fromYear) + " to " + (toYear + 1996);
                    console.log(from_to)
                    $("#from_to").html(from_to)
                    //create the plot area on the plotdiv element
                    var req = $("#plotdiv").rplot("plotIPY", {
                    fromYear,
                            toYear
                    })

                            console.log(req)
                    // if R returns an error, alert
                    // USER
                    req.fail(function () {
                        alert("Server error: " + req.responseText + "");
                    });
                    //after request complete, re-enable the button
                    req.always(function () {
                        $("#submitbutton").removeAttr("disabled")
                    });
                });
                $("#endYr").change(function (event) {
                    //read the value for 'myname'
                    var fromYear = parseInt($("#startYr").val());
                    var toYear = parseInt($("#endYr").val());
                    var from_to = (1996 + fromYear) + " to " + (toYear + 1996);
                    console.log(from_to)
                    $("#from_to").html(from_to)
                    //create the plot area on the plotdiv element
                    var req = $("#plotdiv").rplot("plotIPY", {
                    fromYear,
                            toYear
                    })

                            console.log(req)
                    //if R returns an error, alert the error message
                    req.fail(function () {
                        alert("Server error: " + req.responseText);
                    });
                    //after request complete, re-enable the button
                    req.always(function () {
                        $("#submitbutton").removeAttr("disabled")
                    });
                    });
                            $("#startYr").change(function (event) {
                        //read the value for 'myname'
                        var fromYear = parseInt($("#startYr").val());
                        var toYear = parseInt($("#endYr").val());
                        var from_to = (1996 + fromYear) + " to " + (toYear + 1996);
                        console.log(from_to)
                        $("#from_to").html(from_to)
                        //create the plot area on the plotdiv element
                        var req = $("#plotdiv").rplot("plotIPY", {
                        fromYear,
                                toYear
                    })

                    console.log(req)
                    //if R returns an error, alert the error message
                    req.fail(function () {
                        alert("Server error: " + req.responseText);
                    });
                    //after request complete, re-enable the button
                    req.always(function () {
                        $("#submitbutton").removeAttr("disabled")
                    });
                });

            });
        </script>
        <style>
            #plotdiv {
                position: relative;
                width: 90%;
                height: 500px;
                padding: 5px;
                border-radius: 3px;
                margin-left: 30px;
            }
        </style>
    </head>
    <body>
        <div class="h4 nav">
            <h3 class="text-center">INTERACTIONS VS Year<br/><span id="from_to"></span></h3>
            <b>Start Year</b>
            <select id="startYr" class="form-control">
                <option value="1">1997</option>
                <option value="2">1998</option>
                <option value="3">1999</option>
                <option value="4">2000</option>
                <option value="5">2001</option>
                <option value="6">2002</option>
                <option value="7">2003</option>
                <option value="8">2004</option>
                <option value="9">2005</option>
                <option value="10">2006</option>
                <option value="11">2007</option>
                <option value="12">2008</option>
                <option value="13">2009</option>
                <option value="14">2010</option>
                <option value="15">2011</option>
                <option value="16">2012</option>
            </select>
            <b>End Year</b>
            <select id="endYr" class="form-control">
                <option value="2">1998</option>
                <option value="3">1999</option>
                <option value="4">2000</option>
                <option value="5">2001</option>
                <option value="6">2002</option>
                <option value="7">2003</option>
                <option value="8">2004</option>
                <option value="9">2005</option>
                <option value="10">2006</option>
                <option value="11">2007</option>
                <option value="12">2008</option>
                <option value="13">2009</option>
                <option value="14">2010</option>
                <option value="15">2011</option>
                <option value="16">2012</option>
                <option value="17">2013</option>
                <option value="18">2014</option>
            </select>
            <button id="submitbutton" type="button" class="btn btn-xs btn-primary">Get Plots</button>
        </div>
        <div id="plotdiv"></div>
    </body>
</html>